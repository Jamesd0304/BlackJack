
'use strict';console.log("test");var color=document.getElementById("color");var name=document.getElementById("name");var start=document.getElementById("start");var body=document.getElementById("body");var user=document.getElementById("user");var minbet=document.getElementById('bet-min');var maxBet=document.getElementById('bet-max');var betfive=document.getElementById('bet-5');var deal=document.getElementById('deal');var hit=document.getElementById('hit');var stay=document.getElementById('stay');var _double=document.getElementById('double');var split=document.getElementById('split');var currentBt=document.getElementById('current-bet');var chipCount=document.getElementById('chip-count');var dealerCard1=document.getElementById('dealer-card-1');var dealerCard2=document.getElementById('dealer-card-2');window['dealerCard3']=document.getElementById('dealer-card-3');var dealerCard4=document.getElementById('dealer-card-4');var dealerCard5=document.getElementById('dealer-card-5');var dealerCard6=document.getElementById('dealer-card-6');var playerCard1=document.getElementById('player-card-1');var playerCard2=document.getElementById('player-card-2');var playerCard3=document.getElementById('player-card-3');var playerCard4=document.getElementById('player-card-4');var playerCard5=document.getElementById('player-card-5');var playerCard6=document.getElementById('player-card-6');var dealerHandTot=document.getElementById('dealer-hand-total');var playerHandTot=document.getElementById('player-hand-total');var cardReset=document.getElementsByClassName('reset-src');var message=document.getElementById('message');var playerHandVal=0;var dealerHandVal=0;var cardVal=0;deal.disabled=true;hit.disabled=true;stay.disabled=true;var chipTotal=0;currentBt.value=0;currentBt.innerText=0;var currentBet=0;color.addEventListener('change',create);name.addEventListener('change',newUser);minbet.addEventListener('click',betMin);maxBet.addEventListener('click',betMax);betfive.addEventListener('click',betFive);deal.addEventListener('click',function(){dealNew("https://cors-anywhere.herokuapp.com/https://deckofcardsapi.com/api/deck/4zakt0un65c4/draw/?count=4");minbet.disabled=true;betfive.disabled=true;maxBet.disabled=true;});hit.addEventListener('click',function(){newHit("https://cors-anywhere.herokuapp.com/https://deckofcardsapi.com/api/deck/4zakt0un65c4/draw/?count=1");});stay.addEventListener('click',function(){if(dealerHandVal<=14){dealerStay("https://cors-anywhere.herokuapp.com/https://deckofcardsapi.com/api/deck/4zakt0un65c4/draw/?count=1");}else{stayEval();}});if(sessionStorage.getItem("chip Count")!=undefined){chipCount.innerText=sessionStorage.getItem("chip Count");chipTotal=sessionStorage.getItem("chip Count");}else{chipTotal=200;}
if(sessionStorage.getItem("color")!=undefined){body.style.backgroundColor=sessionStorage.getItem("color");color.value=sessionStorage.getItem("color");}else{body.style.backgroundColor="white";color.value='#ffffff';}
if(sessionStorage.getItem("name")!=undefined){name.value=sessionStorage.getItem("name");user.innerText=name.value;}else{name.value="Hello Player 1";user.innerText=name.value;}
function betMin(){if(Number(currentBt.innerText)<=18){deal.disabled=false;currentBet+=2;currentBt.innerText=currentBet;chipTotal-=2;console.log(chipTotal);chipCount.innerText=chipTotal;}}
function betFive(){if(Number(currentBt.innerText)<=15){deal.disabled=false;currentBet+=5;currentBt.innerText=currentBet;chipTotal-=5;console.log(chipTotal);chipCount.innerText=chipTotal;}}
function betMax(){if(Number(currentBt.innerText)==0){deal.disabled=false;currentBet+=20;currentBt.innerText=currentBet;chipTotal-=20;console.log(chipTotal);chipCount.innerText=chipTotal;}}
function create(){sessionStorage.setItem("color",color.value);body.style.backgroundColor=color.value;}
function newUser(){sessionStorage.setItem("name",name.value);user.innerText=name.value;}
function chipStorage(){sessionStorage.setItem("chip Count",chipCount.innerText);}
function resetSrc(){setTimeout(function(){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=cardReset[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var item=_step.value;item.removeAttribute("src");message.innerText='';}}catch(err){_didIteratorError=true;_iteratorError=err;}finally{try{if(!_iteratorNormalCompletion&&_iterator["return"]!=null){_iterator["return"]();}}finally{if(_didIteratorError){throw _iteratorError;}}}},3000);}
function reShuffle(url){var req=new XMLHttpRequest();req.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var data=JSON.parse(this.response);console.log(data);}};req.open("GET",url);req.send();}
function newHit(url){var req=new XMLHttpRequest();req.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var data=JSON.parse(this.response);console.log(playerCard3.src);if(playerCard3.src==""){playerCard3.src=data.cards[0].image;playerCard3.setAttribute("cardval",valuator(data.cards[0].value));playerHandVal+=Number(playerCard3.getAttribute("cardval"));playerHandTot.innerText=playerHandVal;busted();}else if(playerCard4.src==""){playerCard4.src=data.cards[0].image;playerCard4.setAttribute("cardval",valuator(data.cards[0].value));playerHandVal+=Number(playerCard4.getAttribute("cardval"));playerHandTot.innerText=playerHandVal;busted();}else if(playerCard5.src==""){playerCard5.src=data.cards[0].image;playerCard5.setAttribute("cardval",valuator(data.cards[0].value));playerHandVal+=Number(playerCard5.getAttribute("cardval"));playerHandTot.innerText=playerHandVal;busted();}else if(playerCard6.src==""){playerCard6.src=data.cards[0].image;playerCard3.setAttribute("cardval",valuator(data.cards[0].value));playerHandVal+=Number(playerCard6.getAttribute("cardval"));playerHandTot.innerText=playerHandVal;busted();}}};req.open("GET",url);req.send();}
function dealerStay(url){var cardNum=3;var req=new XMLHttpRequest();req.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var data=JSON.parse(this.response);console.log(window['dealerCard'+cardNum]);var currentCard=window['dealerCard'+cardNum];currentCard.setAttribute("cardval",valuator(data.cards[0].value));currentCard.src=data.cards[0].image;console.log(dealerHandVal);dealerHandVal+=Number(currentCard.getAttribute("cardval"));console.log(dealerHandVal);dealerHandTot.innerText=dealerHandVal;console.log(cardNum);stayEval();}};req.open("GET",url);req.send();}
function valuator(card){if(card==='ACE'){return 11;}
if(card==='JACK'||card==='QUEEN'||card==='KING'){return 10;}else{return card;}}
function dealNew(url){var req=new XMLHttpRequest();req.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var data=JSON.parse(this.response);if(data.remaining<=146){reShuffle("https://deckofcardsapi.com/api/deck/4zakt0un65c4/shuffle/");}
dealerCard1.setAttribute("cardval",valuator(data.cards[0].value));dealerCard1.src=data.cards[0].image;dealerCard2.setAttribute("cardval",valuator(data.cards[1].value));dealerCard2.src=data.cards[1].image;playerCard1.setAttribute("cardval",valuator(data.cards[2].value));playerCard1.src=data.cards[2].image;playerCard2.setAttribute("cardval",valuator(data.cards[3].value));playerCard2.src=data.cards[3].image;dealerHandVal=Number(dealerCard1.getAttribute("cardval"))+Number(dealerCard2.getAttribute("cardval"));playerHandVal=Number(playerCard1.getAttribute("cardval"))+Number(playerCard2.getAttribute("cardval"));playerHandTot.innerText=playerHandVal;dealerHandTot.innerText=dealerHandVal;hit.disabled=false;stay.disabled=false;if(dealerHandVal<=20&&playerHandVal==21){chipCount.innerText=currentBet*3+chipTotal;chipTotal=chipCount.innerText;console.log('BLACKJACK!');message.innerText='BLACKJACK!!!';resetHand();}else if(dealerHandVal==21&&playerHandVal<dealerHandVal){chipCount.innerText=chipTotal-currentBet;chipTotal=chipCount.innerText;console.log('SORRY YOU LOST THE HAND');message.innerText='YOU LOST!';resetHand();}else if(dealerHandVal>14&&playerHandVal>=dealerHandVal){chipCount.innerText=currentBet*2+chipTotal;chipTotal=chipCount.innerText;console.log('YOU WIN');message.innerText='YOU WIN!';resetHand();}}};req.open("GET",url);req.send();}
function resetHand(){currentBet=0;currentBt.innerText=currentBet;playerHandVal=0;playerHandTot.innerText=playerHandVal;dealerHandVal=0;dealerHandTot.innerText=dealerHandVal;minbet.disabled=false;betfive.disabled=false;maxBet.disabled=false;deal.disabled=true;hit.disabled=true;stay.disabled=true;chipStorage();resetSrc();}
function busted(){if(playerHandVal>21){console.log('YOU BUSTED');chipTotal-=currentBet;chipCount.innerText=chipTotal;message.innerText='YOU LOST!';resetHand();}}
function stayEval(){if(dealerHandVal>21){chipCount.innerText=currentBet*2+chipTotal;chipTotal=chipCount.innerText;console.log('YOU WIN');message.innerText='YOU WIN!';resetHand();}else if(dealerHandVal<=playerHandVal){chipCount.innerText=currentBet*2+chipTotal;chipTotal=chipCount.innerText;console.log('YOU WIN');message.innerText='YOU WIN!';resetHand();}else if(playerHandVal<dealerHandVal){chipCount.innerText=chipTotal-currentBet;chipTotal=chipCount.innerText;console.log('SORRY YOU LOST THE HAND');message.innerText='YOU LOST!';resetHand();}}
